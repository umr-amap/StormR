<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>temporalBehaviour • StormR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="temporalBehaviour">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StormR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ExtractStorms.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change log</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/umr-amap/StormR"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>temporalBehaviour</h1>
            
            <h4 data-toc-skip class="date">2024-08-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/umr-amap/StormR/blob/master/vignettes/TemporalBehaviour.Rmd" class="external-link"><code>vignettes/TemporalBehaviour.Rmd</code></a></small>
      <div class="d-none name"><code>TemporalBehaviour.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../reference/temporalBehaviour.html">temporalBehaviour()</a></code> function allows computing wind
speed and direction for a given location or set of locations along the
lifespan of a tropical cyclone. It also allows to compute to compute
three associated summary statistics: the maximum sustained wind speed
(<code>product="MSW"</code>), the power dissipation index
(<code>product="PDI"</code>) and the duration of exposure to winds
reaching defined speed thresholds along the life span of the cyclones
(<code>product="Exposure"</code>).</p>
<p>In the following example we use the <code>test_dataset</code>
provided with the package to illustrate how cyclone track data can be
used to compute and plot time series of wind speed and direction and how
to compute summary statistics for specific locations, as described
below.</p>
<div class="section level3">
<h3 id="computing-and-plotting-time-series-of-wind-speed-and-direction">Computing and plotting time series of wind speed and direction<a class="anchor" aria-label="anchor" href="#computing-and-plotting-time-series-of-wind-speed-and-direction"></a>
</h3>
<p>We compute and plot time series of the speed and direction of winds
generated by the topical cyclone Pam (2015) in two of the main cities of
Vanuatu, Port Vila (longitude = 168.33, latitude = -17.73) and
Luganville (longitude = 167.17, latitude = -15.53). The coordinates of
the two locations of interest are provided in a data frame as
follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">168.33</span>, <span class="fl">167.17</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">17.73</span>, <span class="op">-</span><span class="fl">15.53</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Port_Vila"</span>, <span class="st">"Luganville"</span><span class="op">)</span></span></code></pre></div>
<p>The track data for Pam nearby Vanuatu are extracted as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defStormsDataset.html">defStormsDataset</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in checkInputsdefStormsDataset(filename, sep, fields, basin, seasons, : No basin argument specified. StormR will work as expected</span></span>
<span><span class="co">##              but cannot use basin filtering for speed-up when collecting data</span></span></code></pre>
<pre><code><span><span class="co">## === Loading data  ===</span></span>
<span><span class="co">## Open database... /home/runner/work/_temp/Library/StormR/extdata/test_dataset.nc opened</span></span>
<span><span class="co">## Collecting data ...</span></span>
<span><span class="co">## === DONE ===</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defStormsList.html">defStormsList</a></span><span class="op">(</span>sds <span class="op">=</span> <span class="va">sds</span>, loi <span class="op">=</span> <span class="st">"Vanuatu"</span>, names <span class="op">=</span> <span class="st">"PAM"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotStorms.html">plotStorms</a></span><span class="op">(</span><span class="va">st</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, <span class="va">df</span><span class="op">$</span><span class="va">y</span>, pch <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, <span class="va">df</span><span class="op">$</span><span class="va">y</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Port Vila"</span>, <span class="st">"Luganville"</span><span class="op">)</span>, pos <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="TemporalBehaviour_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Then the <code><a href="../reference/temporalBehaviour.html">temporalBehaviour()</a></code> function with the
<code>product = "TS"</code> argument is used to compute time series. By
default the temporal resolution of is set to 1 hour but can be changed
using the <code>tempRes</code> argument. Here we set the temporal
resolution to 30 min with <code>tempRes=0.5</code> as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/temporalBehaviour.html">temporalBehaviour</a></span><span class="op">(</span><span class="va">st</span>, points <span class="op">=</span> <span class="va">df</span>, product <span class="op">=</span> <span class="st">"TS"</span>, tempRes <span class="op">=</span> <span class="fl">30</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>With the above specification the <code><a href="../reference/temporalBehaviour.html">temporalBehaviour()</a></code>
function returns a list of two data frames (i.e., one for each location)
with the wind speed (“speed”), direction (“direction”), indices of the
observations and the date and time of the observation (“isoTimes”).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">TS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 1</span></span>
<span><span class="co">##  $ PAM:List of 2</span></span>
<span><span class="co">##   ..$ Port_Vila :'data.frame':   115 obs. of  4 variables:</span></span>
<span><span class="co">##   .. ..$ speed    : num [1:115] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   .. ..$ direction: num [1:115] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   .. ..$ indices  : chr [1:115] "28" "28.17" "28.33" "28.50" ...</span></span>
<span><span class="co">##   .. ..$ isoTimes : chr [1:115] "2015-03-11 21:00:00" "2015-03-11 21:30:00" "2015-03-11 22:00:00" "2015-03-11 22:30:00" ...</span></span>
<span><span class="co">##   ..$ Luganville:'data.frame':   115 obs. of  4 variables:</span></span>
<span><span class="co">##   .. ..$ speed    : num [1:115] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   .. ..$ direction: num [1:115] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   .. ..$ indices  : chr [1:115] "28" "28.17" "28.33" "28.50" ...</span></span>
<span><span class="co">##   .. ..$ isoTimes : chr [1:115] "2015-03-11 21:00:00" "2015-03-11 21:30:00" "2015-03-11 22:00:00" "2015-03-11 22:30:00" ...</span></span></code></pre>
<p>We use the data frame and the <code><a href="../reference/plotTemporal.html">plotTemporal()</a></code> function to
draw time series plots for wind speed and wind direction as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTemporal.html">plotTemporal</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">TS</span>, storm<span class="op">=</span><span class="st">"PAM"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TemporalBehaviour_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTemporal.html">plotTemporal</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">TS</span>, storm<span class="op">=</span><span class="st">"PAM"</span>, var<span class="op">=</span><span class="st">'direction'</span><span class="op">)</span></span></code></pre></div>
<p><img src="TemporalBehaviour_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Maximum sustained wind speed for Port Vila and Luganville can be
computed as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">TS</span><span class="op">$</span><span class="va">PAM</span><span class="op">$</span><span class="va">Port_Vila</span><span class="op">$</span><span class="va">speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 53.312</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">TS</span><span class="op">$</span><span class="va">PAM</span><span class="op">$</span><span class="va">Luganville</span><span class="op">$</span><span class="va">speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 22.112</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="getting-power-dissipation-index">Getting power dissipation index<a class="anchor" aria-label="anchor" href="#getting-power-dissipation-index"></a>
</h3>
<p>The power dissipation index is computed using the
<code>product = "PDI"</code> argument as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PDI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/temporalBehaviour.html">temporalBehaviour</a></span><span class="op">(</span><span class="va">st</span>, points <span class="op">=</span> <span class="va">df</span>, product <span class="op">=</span> <span class="st">"PDI"</span>, tempRes <span class="op">=</span> <span class="fl">30</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">PDI</span></span></code></pre></div>
<pre><code><span><span class="co">## $PAM</span></span>
<span><span class="co">##     Port_Vila Luganville</span></span>
<span><span class="co">## PDI  126105.2   20111.64</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="getting-duration-of-exposure">Getting duration of exposure<a class="anchor" aria-label="anchor" href="#getting-duration-of-exposure"></a>
</h3>
<p>The duration of exposure is computed using the
<code>product = "Exposure"</code> argument as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposure_SS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/temporalBehaviour.html">temporalBehaviour</a></span><span class="op">(</span><span class="va">st</span>, points <span class="op">=</span> <span class="va">df</span>, product <span class="op">=</span> <span class="st">"Exposure"</span>, tempRes <span class="op">=</span> <span class="fl">30</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">exposure_SS</span></span></code></pre></div>
<pre><code><span><span class="co">## $PAM</span></span>
<span><span class="co">##                       Port_Vila Luganville</span></span>
<span><span class="co">## Min threshold: 18 m/s      1380        960</span></span>
<span><span class="co">## Min threshold: 33 m/s       570          0</span></span>
<span><span class="co">## Min threshold: 42 m/s       300          0</span></span>
<span><span class="co">## Min threshold: 49 m/s       120          0</span></span>
<span><span class="co">## Min threshold: 58 m/s         0          0</span></span>
<span><span class="co">## Min threshold: 70 m/s         0          0</span></span></code></pre>
<p>By default, the function returns the duration of exposure (in hours)
to wind speeds above the thresholds used by the Saffir-Simpson hurricane
wind scale (i.e., 18, 33, 42, 49, 58, and 70
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>.</mi><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m.s^{-1}</annotation></semantics></math>).
However, different thresholds can be set using the
<code>wind_threshold</code> arguments. We can use the thresholds used by
the Australian Bureau of Meteorology to rank tropical cyclones intensity
as follow:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17.2</span>, <span class="fl">24.4</span>, <span class="fl">32.5</span>, <span class="fl">44.2</span>, <span class="fl">55.0</span><span class="op">)</span></span>
<span><span class="va">exposure_BOM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/temporalBehaviour.html">temporalBehaviour</a></span><span class="op">(</span><span class="va">st</span>, points <span class="op">=</span> <span class="va">df</span>, product <span class="op">=</span> <span class="st">"Exposure"</span>, tempRes <span class="op">=</span> <span class="fl">30</span>, windThreshold <span class="op">=</span> <span class="va">wt</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">exposure_BOM</span></span></code></pre></div>
<pre><code><span><span class="co">## $PAM</span></span>
<span><span class="co">##                         Port_Vila Luganville</span></span>
<span><span class="co">## Min threshold: 17.2 m/s      1440       1050</span></span>
<span><span class="co">## Min threshold: 24.4 m/s       960          0</span></span>
<span><span class="co">## Min threshold: 32.5 m/s       600          0</span></span>
<span><span class="co">## Min threshold: 44.2 m/s       240          0</span></span>
<span><span class="co">## Min threshold: 55 m/s           0          0</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Baptiste Delaporte, Thomas Ibanez, Gunnar Keppel, Swen Jullien, Christophe Menkes, Thomas Arsouze.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
