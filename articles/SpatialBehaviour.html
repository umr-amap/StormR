<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="StormR">
<title>spatialBehaviour • StormR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="spatialBehaviour">
<meta property="og:description" content="StormR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">StormR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Behaviour.html">Behaviour</a>
    <a class="dropdown-item" href="../articles/DataSource.html">Data source</a>
    <a class="dropdown-item" href="../articles/Models.html">Models</a>
    <a class="dropdown-item" href="../articles/SpatialBehaviour.html">spatialBehaviour</a>
    <a class="dropdown-item" href="../articles/Storms.html">Storms</a>
    <a class="dropdown-item" href="../articles/TemporalBehaviour.html">temporalBehaviour</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>spatialBehaviour</h1>
            
            <h4 data-toc-skip class="date">2023-03-25</h4>
      
      
      <div class="d-none name"><code>SpatialBehaviour.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../reference/spatialBehaviour.html">spatialBehaviour()</a></code> function allows computing wind
speed and direction for each cell of a regular grid (i.e., a raster) for
a given tropical cyclone or set of tropical cyclones. The
<code>product="Profiles"</code> argument allows producing 2D wind fields
during the lifespan of the cyclone at a temporal resolution of up to 15
minutes. The <code><a href="../reference/spatialBehaviour.html">spatialBehaviour()</a></code> function also allows to
compute three associated summary statistics: the maximum sustained wind
speed (<code>product="MSW"</code>), the power dissipation index
(<code>product="PDI"</code>) and the duration of exposure to winds
reaching defined speed thresholds along the life span of the cyclones
(<code>product="Exposure"</code>). Then the <code><a href="../reference/plotBehaviour.html">plotBehaviour()</a></code>
and the <code><a href="../reference/writeRast.html">writeRast()</a></code> functions can be used to visualise and
export the output. In the following example we use the
<code>test_dataset</code> provided with the package to illustrate how
cyclone track data can be used to compute, plot, and export 2D wind
field profiles or summary statistics.</p>
<div class="section level3">
<h3 id="computing-and-plotting-spatialbehaviour-products">Computing and plotting spatialBehaviour products<a class="anchor" aria-label="anchor" href="#computing-and-plotting-spatialbehaviour-products"></a>
</h3>
<p>We can compute the behaviour of winds generated by the topical
cyclone Pam (2015) near Vanuatu. First, track data are extracted as
follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defDatabase.html">defDatabase</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## === Loading data  ===</span></span>
<span><span class="co">## Open database... /home/runner/work/_temp/Library/StormR/extdata/test_dataset.nc opened</span></span>
<span><span class="co">## Collecting data ...</span></span>
<span><span class="co">## === DONE ===</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Storms.html">Storms</a></span><span class="op">(</span>sds<span class="op">=</span><span class="va">sds</span>,loi <span class="op">=</span> <span class="st">"Vanuatu"</span>, names <span class="op">=</span> <span class="st">"PAM"</span>,verbose<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotStorms.html">plotStorms</a></span><span class="op">(</span><span class="va">st</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="section level4">
<h4 id="wind-profiles">Wind profiles<a class="anchor" aria-label="anchor" href="#wind-profiles"></a>
</h4>
<p>Using track data and the <code><a href="../reference/spatialBehaviour.html">spatialBehaviour()</a></code> function
with the <code>product="Profiles</code> argument we can generate 2D wind
fields at any time as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatialBehaviour.html">spatialBehaviour</a></span><span class="op">(</span><span class="va">st</span>,product<span class="op">=</span><span class="st">"Profiles"</span>,verbose<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">pf</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 304, 219, 114  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.04166667, 0.04166667  (x, y)</span></span>
<span><span class="co">## extent      : 163.7083, 172.8333, -23, -10.33333  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 </span></span>
<span><span class="co">## source(s)   : memory</span></span>
<span><span class="co">## names       : PAM_Speed_28, PAM_S~_28.1, PAM_S~_28.2, PAM_Speed_29, PAM_S~_29.1, PAM_S~_29.2, ... </span></span>
<span><span class="co">## min values  :        5.927,       2.302,       3.807,        3.087,       0.848,       2.971, ... </span></span>
<span><span class="co">## max values  :       61.110,      63.420,      64.483,       63.610,      64.753,      65.017, ...</span></span></code></pre>
<p>The function returns a <code>SpatRaster</code> object with two
rasters, one for the wind speed and one for the wind direction, for each
observation or interpolated observation. Rasters’ names follow the
following terminology, the name of the storm in capital letters, “Speed”
or “Direction”, and the index of the observation, separated by
underscores. Note that actual observations have entire indices (e.g.,
41, 42, …) while interpolated observation have decimals (e.g., 41.1,
41.2, …). Most tropical cyclone track data sets are based on
observations gathered every 3 or 6 hours. Therefore, to be able to
compute wind fields every 1 hour, the observations are interpolated.</p>
<p>Wind speed and direction profiles at the 41<sup>th</sup> observation
can be plotted as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBehaviour.html">plotBehaviour</a></span><span class="op">(</span><span class="va">st</span>,<span class="va">pf</span><span class="op">$</span><span class="va">PAM_Speed_41</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBehaviour.html">plotBehaviour</a></span><span class="op">(</span><span class="va">st</span>,<span class="va">pf</span><span class="op">$</span><span class="va">PAM_Direction_41</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="summary-statisics">Summary statisics<a class="anchor" aria-label="anchor" href="#summary-statisics"></a>
</h4>
<p>The <code><a href="../reference/spatialBehaviour.html">spatialBehaviour()</a></code> function can compute the
different <code>products</code> (i.e., <code>"Profiles"</code>,
<code>"MSW"</code>, <code>"PDI"</code>, <code>"Exposure"</code>) either
separately or together. Here, we compute all three summary statistics
together as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatialBehaviour.html">spatialBehaviour</a></span><span class="op">(</span><span class="va">st</span>,product<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSW"</span>,<span class="st">"PDI"</span>,<span class="st">"Exposure"</span><span class="op">)</span>,verbose<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ss</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 304, 219, 8  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.04166667, 0.04166667  (x, y)</span></span>
<span><span class="co">## extent      : 163.7083, 172.8333, -23, -10.33333  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 </span></span>
<span><span class="co">## source(s)   : memory</span></span>
<span><span class="co">## names       : PAM_MSW,     PAM_PDI, PAM_E~re_18, PAM_E~re_33, PAM_E~re_42, PAM_E~re_49, ... </span></span>
<span><span class="co">## min values  : 13.7870,    5.241304,     1.00000,     1.00000,    1.000000,    1.000000, ... </span></span>
<span><span class="co">## max values  : 73.9045, 4692.619898,    30.90083,    14.70248,    9.446281,    6.826446, ...</span></span></code></pre>
<p>The <code><a href="../reference/spatialBehaviour.html">spatialBehaviour()</a></code> function returns a
<code>SpatRaster</code> object with eight rasters: one for the maximum
sustained wind speed (<code>"MSW"</code>), one for the power dissipation
index (<code>"PDI"</code>), and one for each of the six defaults wind
thresholds values set for the duration of exposure
(<code>"Exposure"</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "PAM_MSW"         "PAM_PDI"         "PAM_Exposure_18" "PAM_Exposure_33"</span></span>
<span><span class="co">## [5] "PAM_Exposure_42" "PAM_Exposure_49" "PAM_Exposure_58" "PAM_Exposure_70"</span></span></code></pre>
<p>By default, the function returns the duration of exposure (in hours)
to wind speeds above the thresholds used by the Saffir-Simpson hurricane
wind scale (i.e., 18, 33, 42, 49, 58, and 70 <span class="math inline">\(m.s^{-1}\)</span>). This can be change using the
<code>wind_threshold</code> argument.</p>
<p>The maximum sustained wind speed can be plotted as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBehaviour.html">plotBehaviour</a></span><span class="op">(</span><span class="va">st</span>,<span class="va">ss</span><span class="op">$</span><span class="va">PAM_MSW</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The power dissipation index can be plotted as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBehaviour.html">plotBehaviour</a></span><span class="op">(</span><span class="va">st</span>,<span class="va">ss</span><span class="op">$</span><span class="va">PAM_PDI</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The duration of exposure to wind stronger than 58 <span class="math inline">\(m.s^{-1}\)</span> (i.e., Saffir-Simpson’s
categories 4 and 5) can be plotted as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBehaviour.html">plotBehaviour</a></span><span class="op">(</span><span class="va">st</span>,<span class="va">ss</span><span class="op">$</span><span class="va">PAM_Exposure_58</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="spatio-temporal-resolution">Spatio-temporal resolution<a class="anchor" aria-label="anchor" href="#spatio-temporal-resolution"></a>
</h3>
<p>As in the WorldClim database (<a href="https://worldclim.org/data/worldclim21.html" class="external-link uri">https://worldclim.org/data/worldclim21.html</a>) four
spatial resolutions are available. By default the spatial resolution is
set to 2.5 min (~4.5 km at the equator), but a finer spatial resolution
of 30 s (~1 km at the equator) and coarser spatial resolutions of 5 min
(~9 km at the equator) or 10 min (~18.6 km at the equator) can be set
using the <code>space_res</code> argument. The temporal resolution is
set to 1 hour by default but finer spatial resolution of 0.75, 0.50, or
0.25 hour can be set using the <code>temp_res</code> argument. Maximum
sustained wind speed can be computed at a 10 min spatial resolution and
a 30 min temporal resolution as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spatialBehaviour.html">spatialBehaviour</a></span><span class="op">(</span><span class="va">st</span>,product<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSW"</span><span class="op">)</span>,verbose<span class="op">=</span><span class="fl">0</span>,space_res<span class="op">=</span><span class="st">"10min"</span>,temp_res<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotBehaviour.html">plotBehaviour</a></span><span class="op">(</span><span class="va">st</span>,<span class="va">ss</span><span class="op">$</span><span class="va">PAM_MSW</span><span class="op">)</span></span></code></pre></div>
<p><img src="SpatialBehaviour_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="exporting-spatialbehaviour-products">Exporting spatialBehaviour products<a class="anchor" aria-label="anchor" href="#exporting-spatialbehaviour-products"></a>
</h3>
<p>The <code><a href="../reference/spatialBehaviour.html">spatialBehaviour()</a></code> function returns rasters stored
in a <code>SpatRaster</code> object than can be exported either in
“.tiff” or “.nc” (NetCDF) formats using the <code><a href="../reference/writeRast.html">writeRast()</a></code>
function. Here, we export the maximum sustained wind speed in the
working directory as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/writeRast.html">writeRast</a></span><span class="op">(</span><span class="va">ss</span><span class="op">$</span><span class="va">PAM_MSW</span>, format<span class="op">=</span><span class="st">".tiff"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Baptiste Delaporte, Thomas Ibanez, Gunnar Keppel, Swen Jullien, Christophe Menkes, Thomas Arsouze.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
